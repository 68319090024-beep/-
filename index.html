<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>EQ Monitor Pro v2.1</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        /* ... (ใช้ Style เดิมของคุณ) ... */
        :root { --primary: #38bdf8; --danger: #f43f5e; --success: #10b981; }
        body { font-family: 'Kanit'; background: #0f172a; color: white; text-align: center; }
        .alert-mode { border: 2px solid var(--danger); animation: shake 0.3s infinite; }
        @keyframes shake { 0% {transform: translate(1px, 1px)} 50% {transform: translate(-1px, -2px)} 100% {transform: translate(1px, 1px)} }
    </style>
</head>
<body>
    <div id="main-box" class="glass-card">
        <h1 id="status-text">กำลังโหลด...</h1>
    </div>

    <div>อุณหภูมิ: <span id="v-temp">--</span>°C</div>
    <div>เสียง: <span id="v-sound">--</span></div>
    <div>สั่นสะเทือน: <span id="v-vib">--</span></div>

    <button onclick="sendCommand('BUZZER_TEST')">ทดสอบไซเรน</button>
    <button onclick="sendCommand('BUZZER_OFF')">ปิดการแจ้งเตือน</button>

    <script>
        const firebaseConfig = { databaseURL: "https://kunthida-6ab5a-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        db.ref('earthquake').on('value', (snapshot) => {
            const data = snapshot.val();
            if(!data) return;

            document.getElementById('v-temp').innerText = data.temp;
            
            // ตรวจสอบค่า sound จาก Firebase
            document.getElementById('v-sound').innerText = data.sound === 1 ? "พบความผิดปกติ" : "ปกติ";
            
            // ตรวจสอบสถานะรวมจากบอร์ด
            const mainBox = document.getElementById('main-box');
            if(data.status === 1) {
                document.getElementById('status-text').innerText = "แจ้งเตือน!";
                mainBox.classList.add('alert-mode');
            } else {
                document.getElementById('status-text').innerText = "ปลอดภัย";
                mainBox.classList.remove('alert-mode');
            }
        });

        function sendCommand(cmd) {
            // ส่งคำสั่งไปที่โฟลเดอร์ control ตามโครงสร้างในรูป
            db.ref('earthquake/control').update({ command: cmd, timestamp: Date.now() });
        }
    </script>
</body>
</html>
